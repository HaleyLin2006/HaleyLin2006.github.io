.. Astrophysics Early Star Formation @NTHU documentation master file, created by
   sphinx-quickstart on Mon Oct 16 11:20:20 2023.
   You can adapt this file completely to your liking, but it should at least
   contain the root `toctree` directive.

Welcome to Astrophysics Early Star Formation @NTHU's documentation!
===================================================================

Introduction
------------
This project studies the viscuous disk evolution in early star formation process, 
in particularly interested in the disk formation efficiency. The disk formation efficiency is the mass ratio 
between the star and the disk at a given time. The disk formation efficiency subsequently implies the stellar 
and planetary formation process as we study the density, temperature, and velocity profile of the envelope and disk. 
These profiles marked the birthplace of planets and comets and could assist us in understanding the chemical evolution 
of the solar system.

I based my research on Visser (2009), with major contribution on

1. **Changing Viscosity Profile.**
   
   Visser (2009) assumed an uniform viscosity through out all radius. However, this assumption is unrealistic as in real world, 
   as we go closer to the protostar the temperature increases, the gas ionizes, and the viscous evolution near protostar is 
   dominated magneticism with different alpha description. Same for the outer area, which is dominated by self-gravity. 
   Therefore, we adopted three alpha description to density for the three regions, the magneticism-dominated part, 
   the "normal" part, and the self-gravity-dominated part. 

2. **Changing the Definition of Boundary**

   Visser (2009) adopted the definition of boundary to be a certain threshhold of density. However, we define the boundary as the 
   pressure-gravity equilibrium, as commonly used for defining the outer boundary of envelope. In adopting this new definition of boundary,
   we let the heat generated by the outflow and protostar to influence the pressure-gravity equilibrium, therfore, we would see a different
   geometry and mass profile for disk and also a different disk formation efficiency compare to the original paper.

Theory
--------
A typical star formation process is postulated to begin with a cold molecular cloud. Then, some instability in the cloud lead to 
instability of gravity-pressure equilibrium and gravitational collapse. Rotation, magnetic fields, viscosity, and other factors 
then take over establishing a flattened density structure. The formation and development of such flattened density structure, 
later on becoming the disk, accounts for the excess angular momentum of the initial molecular cloud compared to the angular momentum 
of a minimum-mass nebula (Terebey, Shu & Cassen, 1984). While the disk develops, the protostar continues to accrete matter from the disk. 
The bipolar jet outflow is formed in this stage as a result of the conservation of angular momentum. The parcels in the disk will later on 
become planets and comets of the solar system. 

**Shu (1977)**

   Shu (1977) assumes spherical symetry, that is the isothermal gravitational collapse without rotation. The case of gravitational collapse
   without rotation is an essential building block for later discussion, as cases with rotation can be considered as perturbed cases for 
   non-rotating ones with the assumption of small angular velocity. Moreover, we will have spherical symmetry for collapse without rotation, 
   which simplifies the calculation. Shu (1977), both of which assumes spherical symmetry and an isothermal, smooth sphere without magnetic field.

   Shu (1977) adopted Eulerian equation of motion to obtain self-similar, time dependent collapse solution. The equations read: 
   
   .. math::

      \frac{\partial M}{\partial t}+u\frac{\partial M}{\partial r}=0, \quad \frac{\partial M}{\partial r}=4\pi r^2\rho

      \frac{\partial \rho}{\partial t}+\frac{1}{r^2}\frac{\partial}{\partial r}(r^2\rho u)=0 
      
      \frac{\partial u}{\partial t}+u\frac{\partial u}{\partial r}=-\frac{a^2}{\rho}\frac{\partial\rho}{\partial r}-\frac{GM}{r^2}

   Unlike the infall model (see Penston, 1969), the physical image of Shu (1977) treat the gas sphere as a whole. He considered an initial 
   density distribution sustained by pressure-gravity equilibrium :math:`\rho(r)=\frac{a^2}{2\pi G}r^{-2}`, :math:`a` being the sound speed. The gas sphere 
   collapses due to some initial perturbation, causing gravity to overcome pressure. Then, an "expansion wave" of speed equivalent to the sound speed 
   :math:`x=r/at`, :math:`x` being the head of expansion wave, start to traverse across the gas sphere. For those radius :math:`r<x`, starts to freefall.

   Note that :math:`x` is dimensionless, we could change other parameters into dimensionless similarity variable

   .. math::

      \rho(r,t)=\frac{\alpha(x)}{4\pi G t^2}, \quad u(r,t)=av(x), \quad M(r,t)= \frac{a^3t}{G}m(x)

   With some algebra, the equation of motion becomes

   .. math::

      ((x-v)^2-1) \frac{1}{\alpha} \frac{d\alpha}{dx} = (\alpha - \frac{2}{x}(x-v))(x-v)
      
      ((x-v)^2-1) \frac{dv}{dx} = (\alpha(x-v) - \frac{2}{x})(x-v)

   In practical simulation, we adopt parameter :math:`z=1/x, dx=-dz/z^2` and initial condition :math:`z\to 0, u\to 0, \alpha\to 0`.

**Terebey, Shu, Cassen (1984)**

   Terebey, Shu, and Cassen (1984, TSC84) is a time-dependent solution. It is aperturbation to Shu (1977) with small rotation, adopting Eulerian equation of motion. 
   TSC84 studies isothermal, smooth gas nebula with small rotation and initial density of :math:`\rho\propto r^{-2}`. TSC84 do not assumes spherical symmetry as it
   assumes an initial small rotation and disregards the effect of magnetic field. 

   TSC84 essentially conduct perturbation with small rotation on existing Shu (1977) equation of motion. Therefore, they have the same equation of motion. 
   However, with velocity of three directions including radial :math:`r`, :math:`\theta`, and :math:`\phi`.

   .. math::
      
      \begin{cases}
         \frac{\partial\rho}{\partial t}+\nabla \cdot(\rho u)=0

         \frac{\partial u}{\partial t}+\nabla(\frac{1}{2}|u|^2)+(\nabla \times u)\times u = -\frac{a^2}{\rho}\nabla\rho-\nabla\mathcal{V}
   
         \nabla^2\mathcal{V}=4\pi G\rho
      \end{cases}
   
   where :math:`\mathcal{V}` is the gravitational potential and other variables have their usual meaning.

   Then, similar logic from S76 can be followed to transform into dimensionless variables :math:`(x,\theta,\tau)`
   (TSC84 Eq. 14), with :math:`x` still indicating the expansion wave front.

   .. math::

      x=\frac{r}{at}, \quad \tau=\Omega t

   The density and velocity are transformed with dimensionless variable :math:`\alpha, V, W, \Gamma, \Psi` (TSC84 Eq. 16).
   
   .. math::
      \rho(r,\theta,t)=\frac{\Omega^2}{4\pi G\tau^2}\alpha(x,\theta,\tau)
      
      u_r(r,\theta,t)=aV(x,\theta,\tau) \quad 
      
      u_\theta(r,\theta,t)=aW(x,\theta,\tau)
      
      (r\sin\theta)u_\phi(r,\theta,t)=\frac{a^2}{\Omega}\Gamma(x,\theta,\tau)
      
      \mathcal{V}(r,\theta,t)=a^2\Psi(x,\theta,\tau)

   Under the condition of small rotation, the rotation factor is supposed to be a perturbation of the static solution. 
   The reduced variables can be expanded with series in :math:`\tau^2` (TSC Eq. 48)

   .. math::
      \alpha(x,\theta,\tau)=\alpha_0(x)+\tau^2\alpha_2^*(x,\theta)+...
   
      V(x,\theta,\tau)=V_0(x)+\tau^2V_2^*(x,\theta)+...
  
      \Psi(x,\theta,\tau)=\Psi_0(x)+\tau^2\Psi_2^*(x,\theta)

   Notice that :math:`W, \Gamma` don't depend on :math:`x`, where :math:`W=\tau^2W_2+...`. Therefore, under small rotation, 
   :math:`W` and :math:`\Gamma` go to zero.

   The perturbation is split into quadrupolar (non-radial) and monopolar (radial) parts (TSC Eq. 49).

   .. math::

      \alpha_2^*(x,\theta)=\alpha_M^*(x)+\alpha_Q^*(x)P_2(\mu)
   
      V_2^*(x,\theta)=V_M^*(x)+V_Q(x)P_2(\mu)
   
      \Psi_2^*(x,\theta) = \Psi_M^*(x)+\Psi_Q^*(x)P_2(\mu)
   
      W_2^*(x,\theta) = W_Q^*(x)\frac{d}{d\theta}[P_2(\mu)]

   With the above preparation, we can study the quadrupolar contribution and monopolar contribution separately. 
   We start with quadrupolar terms (TSC Eq. 69, 23)

   .. math::

      ((x-V_0)^2-1)\frac{d\alpha_Q^*}{dx}=(x-V_0)A_Q^*+\alpha_0B_Q
      
      ((x-V_0)^2-1)\frac{dV_Q^*}{dx}=(x-V_0)B_Q^*+\frac{A_Q^*}{\alpha_0}
      
      (x-V_0)x\frac{dW_Q}{dx}=(2x+V_0)W_Q+\frac{\alpha_Q^*}{\alpha_0}+\Psi_Q+\frac{(m_0/2)^4}{3x^2}
      
      \Psi_Q^*= -\frac{x^2}{3}-\frac{Q^*}{x^3}-x^2P^*

   in which 

   .. math::
   
      Q^*=\frac{1}{5}\int_0^x\alpha_Q^*(\chi)\chi^4d\chi, P^*=\frac{1}{5}\int_x^\infty\alpha_Q^*(\chi)\frac{d\chi}{\chi}
   
      A_Q^* = \frac{\alpha_Q^*}{x^2}\frac{d}{dx}(x^2V_0)+\frac{V_Q^*}{x^2}\frac{d}{dx}(x^2\alpha_0)-\frac{6}{x}\alpha_0W_Q
   
      B_Q^* = -\frac{\alpha_Q^*}{\alpha_0^2}\frac{d\alpha_0}{dx}+(2+\frac{dV_0}{dx})V_Q^*+\frac{d\Psi_Q^*}{dx}-\frac{2}{3}\frac{(m_0/2)^4}{x^3}
   
      m_0(x)=x^2\alpha_0(x-V_0)

   where :math:`\alpha_0,v_0` is the solution from S77.

   The equation of motion for monopolar is derived in a similar fashion. (TSC Eq. 73, 74)

   .. math::

      ((x-V_0)^2-1)\frac{d\alpha_M^*}{dx}=(x-V_0)A_M^*+\alpha_0B_M
   
      ((x-V_0)^2-1)\frac{dV_M^*}{dx}=(x-V_0)B_M^*+\frac{A_M^*}{\alpha_0}
   
   in which

   .. math::

      A_M^* = \frac{\alpha_M^*}{x^2} \frac{d}{dx}(x^2 V_0) + \frac{V_M^*}{x^2} \frac{d}{dx}(x^2\alpha_0)
   
      B_M^* = -\frac{\alpha_M^*}{\alpha_0^2} \frac{d\alpha_0}{dx} + (2+\frac{dV_0}{dx})V_M^* + \frac{d\Psi_M^*}{dx} - \frac{2}{3}\frac{(m_0/2)^4}{x^3}
   
      \frac{d\Psi_M^*}{dx} = \frac{x}{6} + \frac{M^*}{x^2}
   
      M^* = -\int_z^\infty (\alpha_M^* (x^\prime)-1/2) (x^\prime)^2 dx^\prime

      m_0(x) = x^2\alpha_0(x-V_0)

   We solve the equation for :math:`x>1` and :math:`x<1` separately as :math:`x=1`, the head of the expansion wave, is physically discontinuous. 
   Moreover, for both quadrupolar and monopolar :math:`x>1`, outside the expansion wave, we have :math:`V_0=0, \alpha_0=\frac{2}{x^2}, m_0=2x` 
   as it has not been perturbed by the collapse yet.

   For the quadrupolar term, we first change to :math:`z=1/x` description, similar to S77. Therefore, the initial condition is :math:`z\to 0, \alpha_Q^* V_Q^*\to 0`.
   With such, we integrate from :math:`z=0.001` to :math:`z=1.001`. We use TSC Eq. 67, 68 to overcome to discontinuous point :math:`z=1`, and plug in the result as the 
   initial condition for :math:`z>1`. Note that the equation of motion for :math:`z>1` cannot be assumed to have :math:`V_0=0, \alpha_0=\frac{2}{x^2}`. However, we use 
   the solution obtained from S77 for :math:`\alpha_0` and :math:`V_0`` in the equation of motion.

- Cassen 

.. toctree::
   :maxdepth: 2
   :caption: Contents:

   modules

Indices and tables
==================

* :ref:`genindex`
* :ref:`modindex`
* :ref:`search`
